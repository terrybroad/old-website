var convnetjs=convnetjs||{REVISION:"ALPHA"};(function(d){var k=false;var e=0;var l=function(){if(k){k=false;return e}var q=2*Math.random()-1;var p=2*Math.random()-1;var s=q*q+p*p;if(s==0||s>1){return l()}var t=Math.sqrt(-2*Math.log(s)/s);e=p*t;k=true;return q*t};var i=function(q,p){return Math.random()*(p-q)+q};var g=function(q,p){return Math.floor(Math.random()*(p-q)+q)};var c=function(q,p){return q+l()*p};var f=function(r){if(typeof(r)==="undefined"||isNaN(r)){return[]}if(typeof ArrayBuffer==="undefined"){var p=new Array(r);for(var q=0;q<r;q++){p[q]=0}return p}else{return new Float64Array(r)}};var n=function(p,q){for(var r=0,s=p.length;r<s;r++){if(p[r]===q){return true}}return false};var o=function(q){var p=[];for(var r=0,s=q.length;r<s;r++){if(!n(p,q[r])){p.push(q[r])}}return p};var b=function(q){if(q.length===0){return{}}var p=q[0];var s=q[0];var r=0;var u=0;var v=q.length;for(var t=1;t<v;t++){if(q[t]>p){p=q[t];r=t}if(q[t]<s){s=q[t];u=t}}return{maxi:r,maxv:p,mini:u,minv:s,dv:p-s}};var j=function(v){var s=v,r=0,p;var u=[];for(var t=0;t<v;t++){u[t]=t}while(s--){r=Math.floor(Math.random()*(s+1));p=u[s];u[s]=u[r];u[r]=p}return u};var h=function(q,v){var t=i(0,1);var s=0;for(var r=0,u=q.length;r<u;r++){s+=v[r];if(t<s){return q[r]}}};var m=function(s,t,p){if(typeof t==="string"){return(typeof s[t]!=="undefined")?s[t]:p}else{var q=p;for(var r=0;r<t.length;r++){var u=t[r];if(typeof s[u]!=="undefined"){q=s[u]}}return q}};function a(q,p){if(!q){p=p||"Assertion failed";if(typeof Error!=="undefined"){throw new Error(p)}throw p}}d.randf=i;d.randi=g;d.randn=c;d.zeros=f;d.maxmin=b;d.randperm=j;d.weightedSample=h;d.arrUnique=o;d.arrContains=n;d.getopt=m;d.assert=a})(convnetjs);(function(b){var a=function(k,g,f,j){if(Object.prototype.toString.call(k)==="[object Array]"){this.sx=1;this.sy=1;this.depth=k.length;this.w=b.zeros(this.depth);this.dw=b.zeros(this.depth);for(var d=0;d<this.depth;d++){this.w[d]=k[d]}}else{this.sx=k;this.sy=g;this.depth=f;var h=k*g*f;this.w=b.zeros(h);this.dw=b.zeros(h);if(typeof j==="undefined"){var e=Math.sqrt(1/(k*g*f));for(var d=0;d<h;d++){this.w[d]=b.randn(0,e)}}else{for(var d=0;d<h;d++){this.w[d]=j}}}};a.prototype={get:function(e,h,g){var f=((this.sx*h)+e)*this.depth+g;return this.w[f]},set:function(e,i,h,g){var f=((this.sx*i)+e)*this.depth+h;this.w[f]=g},add:function(e,i,h,g){var f=((this.sx*i)+e)*this.depth+h;this.w[f]+=g},get_grad:function(e,h,g){var f=((this.sx*h)+e)*this.depth+g;return this.dw[f]},set_grad:function(e,i,h,g){var f=((this.sx*i)+e)*this.depth+h;this.dw[f]=g},add_grad:function(e,i,h,g){var f=((this.sx*i)+e)*this.depth+h;this.dw[f]+=g},cloneAndZero:function(){return new a(this.sx,this.sy,this.depth,0)},clone:function(){var d=new a(this.sx,this.sy,this.depth,0);var f=this.w.length;for(var e=0;e<f;e++){d.w[e]=this.w[e]}return d},addFrom:function(d){for(var e=0;e<this.w.length;e++){this.w[e]+=d.w[e]}},addFromScaled:function(e,d){for(var f=0;f<this.w.length;f++){this.w[f]+=d*e.w[f]}},setConst:function(d){for(var e=0;e<this.w.length;e++){this.w[e]=d}},toJSON:function(){var d={};d.sx=this.sx;d.sy=this.sy;d.depth=this.depth;d.w=this.w;return d},fromJSON:function(e){this.sx=e.sx;this.sy=e.sy;this.depth=e.depth;var f=this.sx*this.sy*this.depth;this.w=b.zeros(f);this.dw=b.zeros(f);for(var d=0;d<f;d++){this.w[d]=e.w[d]}}};var c=function(l,j,h,e,d,g){this.sx=l;this.sy=j;this.depth=h;this.v_sx=e;this.v_sy=d;this.v_depth=g;var k=this.sx*this.sy*this.depth;this.vols=[];for(var f=0;f<k;f++){this.vols.push(new a(this.v_sx,this.v_sy,this.v_depth,0))}};c.prototype={getVols:function(){return this.vols},getVolsLength:function(){return this.vols.length},getVol:function(e,h,g){var f=((this.sx*h)+e)*this.depth+g;return this.vols[f]},getVal:function(e,l,k,i,h,g){var f=((this.sx*l)+e)*this.depth+k;var j;if(this.vols[f]!=undefined){j=this.vols[f].get(i,h,g)}else{j=0}return j},setVal:function(e,l,k,i,h,g,j){var f=((this.sx*l)+e)*this.depth+k;this.vols[f].set(i,h,g,j)},getSx:function(){return this.sx},getSy:function(){return this.sy},getD:function(){return this.d}};b.Vol=a;b.VolofVol=c})(convnetjs);(function(c){var a=c.Vol;var e=c.VolofVol;var b=function(g,i,o,n,h){if(typeof(h)==="undefined"){var h=false}if(typeof(o)==="undefined"){var o=c.randi(0,g.sx-i)}if(typeof(n)==="undefined"){var n=c.randi(0,g.sy-i)}var f;if(i!==g.sx||o!==0||n!==0){f=new a(i,i,g.depth,0);for(var m=0;m<i;m++){for(var l=0;l<i;l++){if(m+o<0||m+o>=g.sx||l+n<0||l+n>=g.sy){continue}for(var k=0;k<g.depth;k++){f.set(m,l,k,g.get(m+o,l+n,k))}}}}else{f=g}if(h){var j=f.cloneAndZero();for(var m=0;m<f.sx;m++){for(var l=0;l<f.sy;l++){for(var k=0;k<f.depth;k++){j.set(m,l,k,f.get(f.sx-m-1,l,k))}}}f=j}return f};var d=function(o,n){if(typeof(n)==="undefined"){var n=false}var h=document.createElement("canvas");h.width=o.width;h.height=o.height;var u=h.getContext("2d");try{u.drawImage(o,0,0)}catch(q){if(q.name==="NS_ERROR_NOT_AVAILABLE"){return false}else{throw q}}try{var v=u.getImageData(0,0,h.width,h.height)}catch(q){if(q.name==="IndexSizeError"){return false}else{throw q}}var g=v.data;var k=o.width;var s=o.height;var t=[];for(var m=0;m<g.length;m++){t.push(g[m]/255-0.5)}var r=new a(k,s,4,0);r.w=t;if(n){var f=new a(k,s,1,0);for(var m=0;m<k;m++){for(var l=0;l<s;l++){f.set(m,l,0,r.get(m,l,0))}}r=f}return r};c.augment=b;c.img_to_vol=d})(convnetjs);(function(c){var a=c.Vol;var e=c.VolofVol;var d=function(h){var h=h||{};this.out_depth=h.filters;this.sx=h.sx;this.in_depth=h.in_depth;this.in_sx=h.in_sx;this.in_sy=h.in_sy;this.sy=typeof h.sy!=="undefined"?h.sy:this.sx;this.stride=typeof h.stride!=="undefined"?h.stride:1;this.pad=typeof h.pad!=="undefined"?h.pad:0;this.l1_decay_mul=typeof h.l1_decay_mul!=="undefined"?h.l1_decay_mul:0;this.l2_decay_mul=typeof h.l2_decay_mul!=="undefined"?h.l2_decay_mul:1;this.out_sx=Math.floor((this.in_sx+this.pad*2-this.sx)/this.stride+1);this.out_sy=Math.floor((this.in_sy+this.pad*2-this.sy)/this.stride+1);this.layer_type="conv";this.A=new a(this.out_sx|1,this.out_sy|1,this.out_depth|1,0);var f=typeof h.bias_pref!=="undefined"?h.bias_pref:0;this.filters=[];for(var g=0;g<this.out_depth;g++){this.filters.push(new a(this.sx,this.sy,this.in_depth))}this.biases=new a(1,1,this.out_depth,f);this.VolofVolofActivations=new e(this.out_sx-1|1,this.out_sy-1|1,this.out_depth|1,this.sx|1,this.sy|1,this.in_depth|1)};d.prototype={forward:function(i,l){this.in_act=i;this.A=new a(this.out_sx|1,this.out_sy|1,this.out_depth|1,0);var A=i.sx|0;var w=i.sy|0;var s=this.stride|0;var m=this.VolofVolofActivations;for(var v=0;v<this.out_depth;v++){var u=this.filters[v];var p=-this.pad|0;var n=-this.pad|0;for(var o=0;o<this.out_sy;n+=s,o++){p=-this.pad|0;for(var q=0;q<this.out_sx;p+=s,q++){var z=0;var t=0;for(var g=0;g<u.sy;g++){var j=n+g;for(var h=0;h<u.sx;h++){var k=p+h;if(j>=0&&j<w&&k>=0&&k<A){for(var r=0;r<u.depth;r++){t=u.w[((u.sx*g)+h)*u.depth+r]*i.w[((A*j)+k)*i.depth+r];if(o+1<this.out_sy&&q+1<this.out_sx){this.VolofVolofActivations.setVal(q,o,v,h,g,r,t)}z+=t}}}}z+=this.biases.w[v];this.A.set(q,o,v,z)}}}this.out_act=this.A;return this.out_act},backward:function(){var j=this.in_act;j.dw=c.zeros(j.w.length);var z=j.sx|0;var w=j.sy|0;var r=this.stride|0;for(var u=0;u<this.out_depth;u++){var s=this.filters[u];var o=-this.pad|0;var m=-this.pad|0;for(var n=0;n<this.out_sy;m+=r,n++){o=-this.pad|0;for(var p=0;p<this.out_sx;o+=r,p++){var g=this.out_act.get_grad(p,n,u);for(var h=0;h<s.sy;h++){var k=m+h;for(var i=0;i<s.sx;i++){var l=o+i;if(k>=0&&k<w&&l>=0&&l<z){for(var q=0;q<s.depth;q++){var v=((z*k)+l)*j.depth+q;var t=((s.sx*h)+i)*s.depth+q;s.dw[t]+=j.w[v]*g;j.dw[v]+=s.w[t]*g}}}}this.biases.dw[u]+=g}}}},getParamsAndGrads:function(){var f=[];for(var g=0;g<this.out_depth;g++){f.push({params:this.filters[g].w,grads:this.filters[g].dw,l2_decay_mul:this.l2_decay_mul,l1_decay_mul:this.l1_decay_mul})}f.push({params:this.biases.w,grads:this.biases.dw,l1_decay_mul:0,l2_decay_mul:0});return f},toJSON:function(){var g={};g.sx=this.sx;g.sy=this.sy;g.stride=this.stride;g.in_depth=this.in_depth;g.out_depth=this.out_depth;g.out_sx=this.out_sx;g.out_sy=this.out_sy;g.layer_type=this.layer_type;g.l1_decay_mul=this.l1_decay_mul;g.l2_decay_mul=this.l2_decay_mul;g.pad=this.pad;g.filters=[];for(var f=0;f<this.filters.length;f++){g.filters.push(this.filters[f].toJSON())}g.biases=this.biases.toJSON();return g},fromJSON:function(h){this.out_depth=h.out_depth;this.out_sx=h.out_sx;this.out_sy=h.out_sy;this.layer_type=h.layer_type;this.sx=h.sx;this.sy=h.sy;this.stride=h.stride;this.in_depth=h.in_depth;this.filters=[];this.l1_decay_mul=typeof h.l1_decay_mul!=="undefined"?h.l1_decay_mul:1;this.l2_decay_mul=typeof h.l2_decay_mul!=="undefined"?h.l2_decay_mul:1;this.pad=typeof h.pad!=="undefined"?h.pad:0;for(var g=0;g<h.filters.length;g++){var f=new a(0,0,0,0);f.fromJSON(h.filters[g]);this.filters.push(f)}this.biases=new a(0,0,0,0);this.biases.fromJSON(h.biases);this.A=new a(this.out_sx|1,this.out_sy|1,this.out_depth|1,0);this.VolofVolofActivations=new e(this.out_sx-1|1,this.out_sy-1|1,this.out_depth|1,this.sx|1,this.sy|1,this.in_depth|1)}};var b=function(h){var h=h||{};this.out_depth=typeof h.num_neurons!=="undefined"?h.num_neurons:h.filters;this.l1_decay_mul=typeof h.l1_decay_mul!=="undefined"?h.l1_decay_mul:0;this.l2_decay_mul=typeof h.l2_decay_mul!=="undefined"?h.l2_decay_mul:1;this.num_inputs=h.in_sx*h.in_sy*h.in_depth;this.in_depth=h.in_depth;this.in_sx=h.in_sx;this.in_sy=h.in_sy;this.out_sx=1;this.out_sy=1;this.layer_type="fc";this.A=new a(this.out_sx|0,this.out_sy|0,this.out_depth|0,0);var f=typeof h.bias_pref!=="undefined"?h.bias_pref:0;this.filters=[];for(var g=0;g<this.out_depth;g++){this.filters.push(new a(1,1,this.num_inputs))}this.biases=new a(1,1,this.out_depth,f);this.VolofVolofActivations=new e(1,1,this.out_depth,1,1,this.num_inputs)};b.prototype={forward:function(h,m){this.in_act=h;this.A=new a(1,1,this.out_depth,0);var l=h.w;for(var j=0;j<this.out_depth;j++){var g=0;var k=0;var f=this.filters[j].w;for(var n=0;n<this.num_inputs;n++){k=l[n]*f[n];g+=k;this.VolofVolofActivations.setVal(0,0,j,0,0,n,k)}g+=this.biases.w[j];this.A.w[j]=g}this.out_act=this.A;return this.out_act},backward:function(){var f=this.in_act;f.dw=c.zeros(f.w.length);for(var g=0;g<this.out_depth;g++){var j=this.filters[g];var h=this.out_act.dw[g];for(var k=0;k<this.num_inputs;k++){f.dw[k]+=j.w[k]*h;j.dw[k]+=f.w[k]*h}this.biases.dw[g]+=h}},getParamsAndGrads:function(){var f=[];for(var g=0;g<this.out_depth;g++){f.push({params:this.filters[g].w,grads:this.filters[g].dw,l1_decay_mul:this.l1_decay_mul,l2_decay_mul:this.l2_decay_mul})}f.push({params:this.biases.w,grads:this.biases.dw,l1_decay_mul:0,l2_decay_mul:0});return f},toJSON:function(){var g={};g.out_depth=this.out_depth;g.out_sx=this.out_sx;g.out_sy=this.out_sy;g.layer_type=this.layer_type;g.num_inputs=this.num_inputs;g.l1_decay_mul=this.l1_decay_mul;g.l2_decay_mul=this.l2_decay_mul;g.filters=[];g.in_depth=this.in_depth;g.in_sx=this.in_sx;g.in_sy=this.in_sy;for(var f=0;f<this.filters.length;f++){g.filters.push(this.filters[f].toJSON())}g.biases=this.biases.toJSON();return g},fromJSON:function(h){this.out_depth=h.out_depth;this.out_sx=h.out_sx;this.out_sy=h.out_sy;this.layer_type=h.layer_type;this.num_inputs=h.num_inputs;this.l1_decay_mul=typeof h.l1_decay_mul!=="undefined"?h.l1_decay_mul:1;this.l2_decay_mul=typeof h.l2_decay_mul!=="undefined"?h.l2_decay_mul:1;this.filters=[];this.in_depth=h.in_depth;this.in_sx=h.in_sx;this.in_sy=h.in_sy;for(var g=0;g<h.filters.length;g++){var f=new a(0,0,0,0);f.fromJSON(h.filters[g]);this.filters.push(f)}this.biases=new a(0,0,0,0);this.biases.fromJSON(h.biases);this.A=new a(this.out_sx|0,this.out_sy|0,this.out_depth|0,0);this.VolofVolofActivations=new e(1,1,this.out_depth,1,1,this.num_inputs)}};c.ConvLayer=d;c.FullyConnLayer=b})(convnetjs);(function(c){var a=c.Vol;var d=c.VolofVol;var b=function(e){var e=e||{};this.sx=e.sx;this.in_depth=e.in_depth;this.in_sx=e.in_sx;this.in_sy=e.in_sy;this.sy=typeof e.sy!=="undefined"?e.sy:this.sx;this.stride=typeof e.stride!=="undefined"?e.stride:2;this.pad=typeof e.pad!=="undefined"?e.pad:0;this.out_depth=this.in_depth;this.out_sx=Math.floor((this.in_sx+this.pad*2-this.sx)/this.stride+1);this.out_sy=Math.floor((this.in_sy+this.pad*2-this.sy)/this.stride+1);this.layer_type="pool";this.switchx=c.zeros(this.out_sx*this.out_sy*this.out_depth);this.switchy=c.zeros(this.out_sx*this.out_sy*this.out_depth);this.A=new a(this.out_sx|1,this.out_sy|1,this.out_depth|1,0)};b.prototype={forward:function(k,t){this.in_act=k;this.A=new a(this.out_sx,this.out_sy,this.out_depth,0);var h=0;for(var o=0;o<this.out_depth;o++){var r=-this.pad;var p=-this.pad;for(var e=0;e<this.out_sx;r+=this.stride,e++){p=-this.pad;for(var u=0;u<this.out_sy;p+=this.stride,u++){var q=-99999;var m=-1,j=-1;for(var l=0;l<this.sx;l++){for(var i=0;i<this.sy;i++){var f=p+i;var g=r+l;if(f>=0&&f<k.sy&&g>=0&&g<k.sx){var s=k.get(g,f,o);if(s>q){q=s;m=g;j=f}}}}h=((this.out_sx*u)+e)*this.out_depth+o;this.switchx[h]=m;this.switchy[h]=j;this.A.set(e,u,o,q)}}}this.out_act=this.A;return this.out_act},backward:function(){var h=this.in_act;h.dw=c.zeros(h.w.length);var f=this.out_act;var g=0;for(var j=0;j<this.out_depth;j++){var l=-this.pad;var k=-this.pad;for(var e=0;e<this.out_sx;l+=this.stride,e++){k=-this.pad;for(var m=0;m<this.out_sy;k+=this.stride,m++){var i=this.out_act.get_grad(e,m,j);h.add_grad(this.switchx[g],this.switchy[g],j,i);g++}}}},getParamsAndGrads:function(){return[]},toJSON:function(){var e={};e.sx=this.sx;e.sy=this.sy;e.stride=this.stride;e.in_depth=this.in_depth;e.out_depth=this.out_depth;e.out_sx=this.out_sx;e.out_sy=this.out_sy;e.layer_type=this.layer_type;e.pad=this.pad;return e},fromJSON:function(e){this.out_depth=e.out_depth;this.out_sx=e.out_sx;this.out_sy=e.out_sy;this.layer_type=e.layer_type;this.sx=e.sx;this.sy=e.sy;this.stride=e.stride;this.in_depth=e.in_depth;this.pad=typeof e.pad!=="undefined"?e.pad:0;this.switchx=c.zeros(this.out_sx*this.out_sy*this.out_depth);this.switchy=c.zeros(this.out_sx*this.out_sy*this.out_depth);this.A=new a(this.out_sx,this.out_sy,this.out_depth,0)}};c.PoolLayer=b})(convnetjs);(function(c){var a=c.Vol;var e=c.VolofVol;var d=c.getopt;var b=function(f){var f=f||{};this.out_depth=d(f,["out_depth","depth"],1);this.out_sx=d(f,["out_sx","sx","width"],1);this.out_sy=d(f,["out_sy","sy","height"],1);this.A=new a(this.out_sx|1,this.out_sy|1,this.out_depth|1,0);this.layer_type="input"};b.prototype={forward:function(f,g){this.in_act=f;this.A=f;this.out_act=f;return this.out_act},backward:function(){},getParamsAndGrads:function(){return[]},toJSON:function(){var f={};f.out_depth=this.out_depth;f.out_sx=this.out_sx;f.out_sy=this.out_sy;f.layer_type=this.layer_type;return f},fromJSON:function(f){this.out_depth=f.out_depth;this.out_sx=f.out_sx;this.out_sy=f.out_sy;this.layer_type=f.layer_type;this.A=new a(this.out_sx|1,this.out_sy|1,this.out_depth|1,0)}};c.InputLayer=b})(convnetjs);(function(e){var a=e.Vol;var f=e.VolofVol;var c=function(g){var g=g||{};this.num_inputs=g.in_sx*g.in_sy*g.in_depth;this.out_depth=this.num_inputs;this.out_sx=1;this.out_sy=1;this.layer_type="softmax";this.A=new a(1,1,this.out_depth,0)};c.prototype={forward:function(h,m){this.in_act=h;this.A=new a(1,1,this.out_depth,0);var g=h.w;var k=h.w[0];for(var j=1;j<this.out_depth;j++){if(g[j]>k){k=g[j]}}var n=e.zeros(this.out_depth);var o=0;for(var j=0;j<this.out_depth;j++){var l=Math.exp(g[j]-k);o+=l;n[j]=l}for(var j=0;j<this.out_depth;j++){n[j]/=o;this.A.w[j]=n[j]}this.es=n;this.out_act=this.A;return this.out_act},backward:function(l){var g=this.in_act;g.dw=e.zeros(g.w.length);for(var j=0;j<this.out_depth;j++){var h=j===l?1:0;var k=-(h-this.es[j]);g.dw[j]=k}return -Math.log(this.es[l])},getParamsAndGrads:function(){return[]},toJSON:function(){var g={};g.out_depth=this.out_depth;g.out_sx=this.out_sx;g.out_sy=this.out_sy;g.layer_type=this.layer_type;g.num_inputs=this.num_inputs;return g},fromJSON:function(g){this.out_depth=g.out_depth;this.out_sx=g.out_sx;this.out_sy=g.out_sy;this.layer_type=g.layer_type;this.num_inputs=g.num_inputs;this.A=new a(1,1,this.out_depth,0)}};var d=function(g){var g=g||{};this.num_inputs=g.in_sx*g.in_sy*g.in_depth;this.out_depth=this.num_inputs;this.out_sx=1;this.out_sy=1;this.layer_type="regression"};d.prototype={forward:function(g,h){this.in_act=g;this.out_act=g;return g},backward:function(m){var g=this.in_act;g.dw=e.zeros(g.w.length);var l=0;if(m instanceof Array||m instanceof Float64Array){for(var k=0;k<this.out_depth;k++){var h=g.w[k]-m[k];g.dw[k]=h;l+=0.5*h*h}}else{if(typeof m==="number"){var h=g.w[0]-m;g.dw[0]=h;l+=0.5*h*h}else{var k=m.dim;var j=m.val;var h=g.w[k]-j;g.dw[k]=h;l+=0.5*h*h}}return l},getParamsAndGrads:function(){return[]},toJSON:function(){var g={};g.out_depth=this.out_depth;g.out_sx=this.out_sx;g.out_sy=this.out_sy;g.layer_type=this.layer_type;g.num_inputs=this.num_inputs;return g},fromJSON:function(g){this.out_depth=g.out_depth;this.out_sx=g.out_sx;this.out_sy=g.out_sy;this.layer_type=g.layer_type;this.num_inputs=g.num_inputs}};var b=function(g){var g=g||{};this.num_inputs=g.in_sx*g.in_sy*g.in_depth;this.out_depth=this.num_inputs;this.out_sx=1;this.out_sy=1;this.layer_type="svm"};b.prototype={forward:function(g,h){this.in_act=g;this.out_act=g;return g},backward:function(n){var h=this.in_act;h.dw=e.zeros(h.w.length);var g=h.w[n];var l=1;var k=0;for(var j=0;j<this.out_depth;j++){if(n===j){continue}var m=-g+h.w[j]+l;if(m>0){h.dw[j]+=1;h.dw[n]-=1;k+=m}}return k},getParamsAndGrads:function(){return[]},toJSON:function(){var g={};g.out_depth=this.out_depth;g.out_sx=this.out_sx;g.out_sy=this.out_sy;g.layer_type=this.layer_type;g.num_inputs=this.num_inputs;return g},fromJSON:function(g){this.out_depth=g.out_depth;this.out_sx=g.out_sx;this.out_sy=g.out_sy;this.layer_type=g.layer_type;this.num_inputs=g.num_inputs}};e.RegressionLayer=d;e.SoftmaxLayer=c;e.SVMLayer=b})(convnetjs);(function(d){var a=d.Vol;var f=d.VolofVol;var e=function(i){var i=i||{};this.out_sx=i.in_sx;this.out_sy=i.in_sy;this.out_depth=i.in_depth;this.layer_type="relu";this.A=new a(this.out_sx|1,this.out_sy|1,this.out_depth|1,0)};e.prototype={forward:function(k,m){this.in_act=k;var j=k.clone();var n=k.w.length;var o=j.w;for(var l=0;l<n;l++){if(o[l]<0){o[l]=0}}this.out_act=j;this.A=j;return this.out_act},backward:function(){var k=this.in_act;var j=this.out_act;var m=k.w.length;k.dw=d.zeros(m);for(var l=0;l<m;l++){if(j.w[l]<=0){k.dw[l]=0}else{k.dw[l]=j.dw[l]}}},getParamsAndGrads:function(){return[]},toJSON:function(){var i={};i.out_depth=this.out_depth;i.out_sx=this.out_sx;i.out_sy=this.out_sy;i.layer_type=this.layer_type;return i},fromJSON:function(i){this.out_depth=i.out_depth;this.out_sx=i.out_sx;this.out_sy=i.out_sy;this.layer_type=i.layer_type;this.A=new a(this.out_sx|1,this.out_sy|1,this.out_depth|1,0)}};var h=function(i){var i=i||{};this.out_sx=i.in_sx;this.out_sy=i.in_sy;this.out_depth=i.in_depth;this.layer_type="sigmoid";this.A=new a(this.out_sx|1,this.out_sy|1,this.out_depth|1,0)};h.prototype={forward:function(k,n){this.in_act=k;var j=k.cloneAndZero();var o=k.w.length;var p=j.w;var m=k.w;for(var l=0;l<o;l++){p[l]=1/(1+Math.exp(-m[l]))}this.out_act=j;this.A=j;return this.out_act},backward:function(){var k=this.in_act;var j=this.out_act;var n=k.w.length;k.dw=d.zeros(n);for(var l=0;l<n;l++){var m=j.w[l];k.dw[l]=m*(1-m)*j.dw[l]}},getParamsAndGrads:function(){return[]},toJSON:function(){var i={};i.out_depth=this.out_depth;i.out_sx=this.out_sx;i.out_sy=this.out_sy;i.layer_type=this.layer_type;return i},fromJSON:function(i){this.out_depth=i.out_depth;this.out_sx=i.out_sx;this.out_sy=i.out_sy;this.layer_type=i.layer_type}};var g=function(i){var i=i||{};this.group_size=typeof i.group_size!=="undefined"?i.group_size:2;this.out_sx=i.in_sx;this.out_sy=i.in_sy;this.out_depth=Math.floor(i.in_depth/this.group_size);this.layer_type="maxout";this.switches=d.zeros(this.out_sx*this.out_sy*this.out_depth)};g.prototype={forward:function(m,z){this.in_act=m;var r=this.out_depth;var w=new a(this.out_sx,this.out_sy,this.out_depth,0);if(this.out_sx===1&&this.out_sy===1){for(var q=0;q<r;q++){var o=q*this.group_size;var v=m.w[o];var s=0;for(var p=1;p<this.group_size;p++){var k=m.w[o+p];if(k>v){v=k;s=p}}w.w[q]=v;this.switches[q]=o+s}}else{var l=0;for(var u=0;u<m.sx;u++){for(var t=0;t<m.sy;t++){for(var q=0;q<r;q++){var o=q*this.group_size;var v=m.get(u,t,o);var s=0;for(var p=1;p<this.group_size;p++){var k=m.get(u,t,o+p);if(k>v){v=k;s=p}}w.set(u,t,q,v);this.switches[l]=o+s;l++}}}}this.out_act=w;return this.out_act},backward:function(){var l=this.in_act;var k=this.out_act;var p=this.out_depth;l.dw=d.zeros(l.w.length);if(this.out_sx===1&&this.out_sy===1){for(var m=0;m<p;m++){var o=k.dw[m];l.dw[this.switches[m]]=o}}else{var r=0;for(var j=0;j<k.sx;j++){for(var q=0;q<k.sy;q++){for(var m=0;m<p;m++){var o=k.get_grad(j,q,m);l.set_grad(j,q,this.switches[r],o);r++}}}}},getParamsAndGrads:function(){return[]},toJSON:function(){var i={};i.out_depth=this.out_depth;i.out_sx=this.out_sx;i.out_sy=this.out_sy;i.layer_type=this.layer_type;i.group_size=this.group_size;return i},fromJSON:function(i){this.out_depth=i.out_depth;this.out_sx=i.out_sx;this.out_sy=i.out_sy;this.layer_type=i.layer_type;this.group_size=i.group_size;this.switches=d.zeros(this.group_size)}};function c(i){var j=Math.exp(2*i);return(j-1)/(j+1)}var b=function(i){var i=i||{};this.out_sx=i.in_sx;this.out_sy=i.in_sy;this.out_depth=i.in_depth;this.layer_type="tanh"};b.prototype={forward:function(k,m){this.in_act=k;var j=k.cloneAndZero();var n=k.w.length;for(var l=0;l<n;l++){j.w[l]=c(k.w[l])}this.out_act=j;return this.out_act},backward:function(){var k=this.in_act;var j=this.out_act;var n=k.w.length;k.dw=d.zeros(n);for(var l=0;l<n;l++){var m=j.w[l];k.dw[l]=(1-m*m)*j.dw[l]}},getParamsAndGrads:function(){return[]},toJSON:function(){var i={};i.out_depth=this.out_depth;i.out_sx=this.out_sx;i.out_sy=this.out_sy;i.layer_type=this.layer_type;return i},fromJSON:function(i){this.out_depth=i.out_depth;this.out_sx=i.out_sx;this.out_sy=i.out_sy;this.layer_type=i.layer_type}};d.TanhLayer=b;d.MaxoutLayer=g;d.ReluLayer=e;d.SigmoidLayer=h})(convnetjs);(function(c){var a=c.Vol;var d=c.VolofVol;var b=function(e){var e=e||{};this.out_sx=e.in_sx;this.out_sy=e.in_sy;this.out_depth=e.in_depth;this.layer_type="dropout";this.drop_prob=typeof e.drop_prob!=="undefined"?e.drop_prob:0.5;this.dropped=c.zeros(this.out_sx*this.out_sy*this.out_depth)};b.prototype={forward:function(f,h){this.in_act=f;if(typeof(h)==="undefined"){h=false}var e=f.clone();var j=f.w.length;if(h){for(var g=0;g<j;g++){if(Math.random()<this.drop_prob){e.w[g]=0;this.dropped[g]=true}else{this.dropped[g]=false}}}else{for(var g=0;g<j;g++){e.w[g]*=this.drop_prob}}this.out_act=e;return this.out_act},backward:function(){var e=this.in_act;var g=this.out_act;var h=e.w.length;e.dw=c.zeros(h);for(var f=0;f<h;f++){if(!(this.dropped[f])){e.dw[f]=g.dw[f]}}},getParamsAndGrads:function(){return[]},toJSON:function(){var e={};e.out_depth=this.out_depth;e.out_sx=this.out_sx;e.out_sy=this.out_sy;e.layer_type=this.layer_type;e.drop_prob=this.drop_prob;return e},fromJSON:function(e){this.out_depth=e.out_depth;this.out_sx=e.out_sx;this.out_sy=e.out_sy;this.layer_type=e.layer_type;this.drop_prob=e.drop_prob}};c.DropoutLayer=b})(convnetjs);(function(c){var a=c.Vol;var d=c.VolofVol;var b=function(e){var e=e||{};this.k=e.k;this.n=e.n;this.alpha=e.alpha;this.beta=e.beta;this.out_sx=e.in_sx;this.out_sy=e.in_sy;this.out_depth=e.in_depth;this.layer_type="lrn";if(this.n%2===0){console.log("WARNING n should be odd for LRN layer")}};b.prototype={forward:function(g,q){this.in_act=g;var f=g.cloneAndZero();this.S_cache_=g.cloneAndZero();var l=Math.floor(this.n/2);for(var o=0;o<g.sx;o++){for(var n=0;n<g.sy;n++){for(var k=0;k<g.depth;k++){var m=g.get(o,n,k);var p=0;for(var h=Math.max(0,k-l);h<=Math.min(k+l,g.depth-1);h++){var e=g.get(o,n,h);p+=e*e}p*=this.alpha/this.n;p+=this.k;this.S_cache_.set(o,n,k,p);p=Math.pow(p,this.beta);f.set(o,n,k,m/p)}}}this.out_act=f;return this.out_act},backward:function(){var h=this.in_act;h.dw=c.zeros(h.w.length);var e=this.out_act;var o=Math.floor(this.n/2);for(var s=0;s<h.sx;s++){for(var r=0;r<h.sy;r++){for(var m=0;m<h.depth;m++){var q=this.out_act.get_grad(s,r,m);var l=this.S_cache_.get(s,r,m);var f=Math.pow(l,this.beta);var t=f*f;for(var k=Math.max(0,m-o);k<=Math.min(m+o,h.depth-1);k++){var p=h.get(s,r,k);var n=-p*this.beta*Math.pow(l,this.beta-1)*this.alpha/this.n*2*p;if(k===m){n+=f}n/=t;n*=q;h.add_grad(s,r,k,n)}}}}},getParamsAndGrads:function(){return[]},toJSON:function(){var e={};e.k=this.k;e.n=this.n;e.alpha=this.alpha;e.beta=this.beta;e.out_sx=this.out_sx;e.out_sy=this.out_sy;e.out_depth=this.out_depth;e.layer_type=this.layer_type;return e},fromJSON:function(e){this.k=e.k;this.n=e.n;this.alpha=e.alpha;this.beta=e.beta;this.out_sx=e.out_sx;this.out_sy=e.out_sy;this.out_depth=e.out_depth;this.layer_type=e.layer_type}};c.LocalResponseNormalizationLayer=b})(convnetjs);(function(d){var a=d.Vol;var e=d.VolofVol;var b=d.assert;var c=function(f){this.layers=[]};c.prototype={makeLayers:function(f){b(f.length>=2,"Error! At least one input layer and one loss layer are required.");b(f[0].type==="input","Error! First layer must be the input layer, to declare size of inputs");var g=function(){var n=[];for(var m=0;m<f.length;m++){var o=f[m];if(o.type==="softmax"||o.type==="svm"){n.push({type:"fc",num_neurons:o.num_classes})}if(o.type==="regression"){n.push({type:"fc",num_neurons:o.num_neurons})}if((o.type==="fc"||o.type==="conv")&&typeof(o.bias_pref)==="undefined"){o.bias_pref=0;if(typeof o.activation!=="undefined"&&o.activation==="relu"){o.bias_pref=0.1}}n.push(o);if(typeof o.activation!=="undefined"){if(o.activation==="relu"){n.push({type:"relu"})}else{if(o.activation==="sigmoid"){n.push({type:"sigmoid"})}else{if(o.activation==="tanh"){n.push({type:"tanh"})}else{if(o.activation==="maxout"){var l=o.group_size!=="undefined"?o.group_size:2;n.push({type:"maxout",group_size:l})}else{console.log("ERROR unsupported activation "+o.activation)}}}}}if(typeof o.drop_prob!=="undefined"&&o.type!=="dropout"){n.push({type:"dropout",drop_prob:o.drop_prob})}}return n};f=g(f);this.layers=[];for(var h=0;h<f.length;h++){var k=f[h];if(h>0){var j=this.layers[h-1];k.in_sx=j.out_sx;k.in_sy=j.out_sy;k.in_depth=j.out_depth}switch(k.type){case"fc":this.layers.push(new d.FullyConnLayer(k));break;case"lrn":this.layers.push(new d.LocalResponseNormalizationLayer(k));break;case"dropout":this.layers.push(new d.DropoutLayer(k));break;case"input":this.layers.push(new d.InputLayer(k));break;case"softmax":this.layers.push(new d.SoftmaxLayer(k));break;case"regression":this.layers.push(new d.RegressionLayer(k));break;case"conv":this.layers.push(new d.ConvLayer(k));break;case"pool":this.layers.push(new d.PoolLayer(k));break;case"relu":this.layers.push(new d.ReluLayer(k));break;case"sigmoid":this.layers.push(new d.SigmoidLayer(k));break;case"tanh":this.layers.push(new d.TanhLayer(k));break;case"maxout":this.layers.push(new d.MaxoutLayer(k));break;case"svm":this.layers.push(new d.SVMLayer(k));break;default:console.log("ERROR: UNRECOGNIZED LAYER TYPE: "+k.type)}}},forward:function(g,j){if(typeof(j)==="undefined"){j=false}var f=this.layers[0].forward(g,j);for(var h=1;h<this.layers.length;h++){f=this.layers[h].forward(f,j)}return f},getCostLoss:function(f,i){this.forward(f,false);var h=this.layers.length;var g=this.layers[h-1].backward(i);return g},backward:function(j){var h=this.layers.length;var g=this.layers[h-1].backward(j);for(var f=h-2;f>=0;f--){this.layers[f].backward()}return g},getParamsAndGrads:function(){var f=[];for(var h=0;h<this.layers.length;h++){var k=this.layers[h].getParamsAndGrads();for(var g=0;g<k.length;g++){f.push(k[g])}}return f},getPrediction:function(){var j=this.layers[this.layers.length-1];b(j.layer_type==="softmax","getPrediction function assumes softmax as last layer of the net!");var k=j.out_act.w;var f=k[0];var g=0;for(var h=1;h<k.length;h++){if(k[h]>f){f=k[h];g=h}}return g},toJSON:function(){var g={};g.layers=[];for(var f=0;f<this.layers.length;f++){g.layers.push(this.layers[f].toJSON())}return g},fromJSON:function(k){this.layers=[];for(var j=0;j<k.layers.length;j++){var g=k.layers[j];var h=g.layer_type;var f;if(h==="input"){f=new d.InputLayer()}if(h==="relu"){f=new d.ReluLayer()}if(h==="sigmoid"){f=new d.SigmoidLayer()}if(h==="tanh"){f=new d.TanhLayer()}if(h==="dropout"){f=new d.DropoutLayer()}if(h==="conv"){f=new d.ConvLayer()}if(h==="pool"){f=new d.PoolLayer()}if(h==="lrn"){f=new d.LocalResponseNormalizationLayer()}if(h==="softmax"){f=new d.SoftmaxLayer()}if(h==="regression"){f=new d.RegressionLayer()}if(h==="fc"){f=new d.FullyConnLayer()}if(h==="maxout"){f=new d.MaxoutLayer()}if(h==="svm"){f=new d.SVMLayer()}f.fromJSON(g);this.layers.push(f)}}};d.Net=c})(convnetjs);(function(b){var a=b.Vol;var d=b.VolofVol;var c=function(f,e){this.net=f;var e=e||{};this.learning_rate=typeof e.learning_rate!=="undefined"?e.learning_rate:0.01;this.l1_decay=typeof e.l1_decay!=="undefined"?e.l1_decay:0;this.l2_decay=typeof e.l2_decay!=="undefined"?e.l2_decay:0;this.batch_size=typeof e.batch_size!=="undefined"?e.batch_size:1;this.method=typeof e.method!=="undefined"?e.method:"sgd";this.momentum=typeof e.momentum!=="undefined"?e.momentum:0.9;this.ro=typeof e.ro!=="undefined"?e.ro:0.95;this.eps=typeof e.eps!=="undefined"?e.eps:1e-8;this.beta1=typeof e.beta1!=="undefined"?e.beta1:0.9;this.beta2=typeof e.beta2!=="undefined"?e.beta2:0.999;this.k=0;this.gsum=[];this.xsum=[];if(this.net.layers[this.net.layers.length-1].layer_type==="regression"){this.regression=true}else{this.regression=false}};c.prototype={train:function(v,u){var m=new Date().getTime();this.net.forward(v,true);var l=new Date().getTime();var t=l-m;var m=new Date().getTime();var D=this.net.backward(u);var n=0;var e=0;var l=new Date().getTime();var J=l-m;if(this.regression&&u.constructor!==Array){console.log("Warning: a regression net requires an array as training output vector.")}this.k++;if(this.k%this.batch_size===0){var k=this.net.getParamsAndGrads();if(this.gsum.length===0&&(this.method!=="sgd"||this.momentum>0)){for(var H=0;H<k.length;H++){this.gsum.push(b.zeros(k[H].params.length));if(this.method==="adam"||this.method==="adadelta"){this.xsum.push(b.zeros(k[H].params.length))}else{this.xsum.push([])}}}for(var H=0;H<k.length;H++){var K=k[H];var B=K.params;var I=K.grads;var C=typeof K.l2_decay_mul!=="undefined"?K.l2_decay_mul:1;var L=typeof K.l1_decay_mul!=="undefined"?K.l1_decay_mul:1;var o=this.l2_decay*C;var r=this.l1_decay*L;var z=B.length;for(var E=0;E<z;E++){n+=o*B[E]*B[E]/2;e+=r*Math.abs(B[E]);var G=r*(B[E]>0?1:-1);var s=o*(B[E]);var w=(s+G+I[E])/this.batch_size;var q=this.gsum[H];var F=this.xsum[H];if(this.method==="adam"){q[E]=q[E]*this.beta1+(1-this.beta1)*w;F[E]=F[E]*this.beta2+(1-this.beta2)*w*w;var h=q[E]*(1-Math.pow(this.beta1,this.k));var f=F[E]*(1-Math.pow(this.beta2,this.k));var A=-this.learning_rate*h/(Math.sqrt(f)+this.eps);B[E]+=A}else{if(this.method==="adagrad"){q[E]=q[E]+w*w;var A=-this.learning_rate/Math.sqrt(q[E]+this.eps)*w;B[E]+=A}else{if(this.method==="windowgrad"){q[E]=this.ro*q[E]+(1-this.ro)*w*w;var A=-this.learning_rate/Math.sqrt(q[E]+this.eps)*w;B[E]+=A}else{if(this.method==="adadelta"){q[E]=this.ro*q[E]+(1-this.ro)*w*w;var A=-Math.sqrt((F[E]+this.eps)/(q[E]+this.eps))*w;F[E]=this.ro*F[E]+(1-this.ro)*A*A;B[E]+=A}else{if(this.method==="nesterov"){var A=q[E];q[E]=q[E]*this.momentum+this.learning_rate*w;A=this.momentum*A-(1+this.momentum)*q[E];B[E]+=A}else{if(this.momentum>0){var A=this.momentum*q[E]-this.learning_rate*w;q[E]=A;B[E]+=A}else{B[E]+=-this.learning_rate*w}}}}}}I[E]=0}}}return{fwd_time:t,bwd_time:J,l2_decay_loss:n,l1_decay_loss:e,cost_loss:D,softmax_loss:D,loss:D+e+n}}};b.Trainer=c;b.SGDTrainer=c})(convnetjs);(function(c){var e=c.randf;var d=c.randi;var j=c.Net;var g=c.Trainer;var b=c.maxmin;var h=c.randperm;var f=c.weightedSample;var i=c.getopt;var k=c.arrUnique;var a=function(m,n,l){var l=l||{};if(typeof m==="undefined"){m=[]}if(typeof n==="undefined"){n=[]}this.data=m;this.labels=n;this.train_ratio=i(l,"train_ratio",0.7);this.num_folds=i(l,"num_folds",10);this.num_candidates=i(l,"num_candidates",50);this.num_epochs=i(l,"num_epochs",50);this.ensemble_size=i(l,"ensemble_size",10);this.batch_size_min=i(l,"batch_size_min",10);this.batch_size_max=i(l,"batch_size_max",300);this.l2_decay_min=i(l,"l2_decay_min",-4);this.l2_decay_max=i(l,"l2_decay_max",2);this.learning_rate_min=i(l,"learning_rate_min",-4);this.learning_rate_max=i(l,"learning_rate_max",0);this.momentum_min=i(l,"momentum_min",0.9);this.momentum_max=i(l,"momentum_max",0.9);this.neurons_min=i(l,"neurons_min",5);this.neurons_max=i(l,"neurons_max",30);this.folds=[];this.candidates=[];this.evaluated_candidates=[];this.unique_labels=k(n);this.iter=0;this.foldix=0;this.finish_fold_callback=null;this.finish_batch_callback=null;if(this.data.length>0){this.sampleFolds();this.sampleCandidates()}};a.prototype={sampleFolds:function(){var o=this.data.length;var m=Math.floor(this.train_ratio*o);this.folds=[];for(var l=0;l<this.num_folds;l++){var n=h(o);this.folds.push({train_ix:n.slice(0,m),test_ix:n.slice(m,o)})}},sampleCandidate:function(){var A=this.data[0].w.length;var z=this.unique_labels.length;var s=[];s.push({type:"input",out_sx:1,out_sy:1,out_depth:A});var l=f([0,1,2,3],[0.2,0.3,0.3,0.2]);for(var m=0;m<l;m++){var n=d(this.neurons_min,this.neurons_max);var v=["tanh","maxout","relu"][d(0,3)];if(e(0,1)<0.5){var r=Math.random();s.push({type:"fc",num_neurons:n,activation:v,drop_prob:r})}else{s.push({type:"fc",num_neurons:n,activation:v})}}s.push({type:"softmax",num_classes:z});var x=new j();x.makeLayers(s);var C=d(this.batch_size_min,this.batch_size_max);var o=Math.pow(10,e(this.l2_decay_min,this.l2_decay_max));var t=Math.pow(10,e(this.learning_rate_min,this.learning_rate_max));var p=e(this.momentum_min,this.momentum_max);var y=e(0,1);var u;if(y<0.33){u={method:"adadelta",batch_size:C,l2_decay:o}}else{if(y<0.66){u={method:"adagrad",learning_rate:t,batch_size:C,l2_decay:o}}else{u={method:"sgd",learning_rate:t,momentum:p,batch_size:C,l2_decay:o}}}var B=new g(x,u);var w={};w.acc=[];w.accv=0;w.layer_defs=s;w.trainer_def=u;w.net=x;w.trainer=B;return w},sampleCandidates:function(){this.candidates=[];for(var l=0;l<this.num_candidates;l++){var m=this.sampleCandidate();this.candidates.push(m)}},step:function(){this.iter++;var r=this.folds[this.foldix];var p=r.train_ix[d(0,r.train_ix.length)];for(var q=0;q<this.candidates.length;q++){var u=this.data[p];var o=this.labels[p];this.candidates[q].trainer.train(u,o)}var n=this.num_epochs*r.train_ix.length;if(this.iter>=n){var m=this.evalValErrors();for(var q=0;q<this.candidates.length;q++){var s=this.candidates[q];s.acc.push(m[q]);s.accv+=m[q]}this.iter=0;this.foldix++;if(this.finish_fold_callback!==null){this.finish_fold_callback()}if(this.foldix>=this.folds.length){for(var q=0;q<this.candidates.length;q++){this.evaluated_candidates.push(this.candidates[q])}this.evaluated_candidates.sort(function(w,l){return(w.accv/w.acc.length)>(l.accv/l.acc.length)?-1:1});if(this.evaluated_candidates.length>3*this.ensemble_size){this.evaluated_candidates=this.evaluated_candidates.slice(0,3*this.ensemble_size)}if(this.finish_batch_callback!==null){this.finish_batch_callback()}this.sampleCandidates();this.foldix=0}else{for(var q=0;q<this.candidates.length;q++){var s=this.candidates[q];var t=new j();t.makeLayers(s.layer_defs);var v=new g(t,s.trainer_def);s.net=t;s.trainer=v}}}},evalValErrors:function(){var t=[];var r=this.folds[this.foldix];for(var p=0;p<this.candidates.length;p++){var s=this.candidates[p].net;var w=0;for(var m=0;m<r.test_ix.length;m++){var u=this.data[r.test_ix[m]];var o=this.labels[r.test_ix[m]];s.forward(u);var n=s.getPrediction();w+=(n===o?1:0)}w/=r.test_ix.length;t.push(w)}return t},predict_soft:function(q){var o=[];var r=0;if(this.evaluated_candidates.length===0){r=this.candidates.length;o=this.candidates}else{r=Math.min(this.ensemble_size,this.evaluated_candidates.length);o=this.evaluated_candidates}var l,m;for(var p=0;p<r;p++){var t=o[p].net;var u=t.forward(q);if(p===0){l=u;m=u.w.length}else{for(var s=0;s<m;s++){l.w[s]+=u.w[s]}}}for(var s=0;s<m;s++){l.w[s]/=r}return l},predict:function(n){var m=this.predict_soft(n);if(m.w.length!==0){var l=b(m.w);var o=l.maxi}else{var o=-1}return o},toJSON:function(){var l=Math.min(this.ensemble_size,this.evaluated_candidates.length);var n={};n.nets=[];for(var m=0;m<l;m++){n.nets.push(this.evaluated_candidates[m].net.toJSON())}return n},fromJSON:function(m){this.ensemble_size=m.nets.length;this.evaluated_candidates=[];for(var l=0;l<this.ensemble_size;l++){var n=new j();n.fromJSON(m.nets[l]);var o={};o.net=n;this.evaluated_candidates.push(o)}},onFinishFold:function(l){this.finish_fold_callback=l},onFinishBatch:function(l){this.finish_batch_callback=l}};c.MagicNet=a})(convnetjs);(function(a){if(typeof module==="undefined"||typeof module.exports==="undefined"){window.convnetjs=a}else{module.exports=a}})(convnetjs);